<!DOCTYPE html>
<html>
<head>
  <title>Kregz Drizel</title>
  <link rel="stylesheet" href="css/stylesheet.css">
</head>
<body>
  <div class="container">
    <h2 id="title">Index Of files</h2>
    <form class="search">
      <input type="text" name="q" placeholder="Search" id="searchInput">
    </form>
    <ul id="file-list"></ul>
  </div>

  <script>
    const owner = "KumisPutih7";
    const repo = "Folder";

    const params = new URLSearchParams(window.location.search);
    const path = params.get("path") || "files";

    document.getElementById("title").innerText = `Index Of /${path}`;

    const list = document.getElementById("file-list");
    
    fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${path}`)
        .then(res => res.json())
        .then(files => {
        

        if (path !== "files") {
            const parent = path.split("/").slice(0, -1).join("/") || "files";
            list.innerHTML += `<li><a href="?path=${parent}">â¬… ..</a></li>`;
        }

        files.sort((a, b) => {
            if (a.type === "dir" && b.type !== "dir") return -1;
            if (a.type !== "dir" && b.type === "dir") return 1;
            return a.name.localeCompare(b.name);
        });

        files.forEach(file => {
            const li = document.createElement("li");

            if (file.type === "dir") {
                li.innerHTML = `ğŸ“ <a href="?path=${file.path}">${file.name}/</a>`;
            } else {
                li.innerHTML = `ğŸ“„ <a href="${file.download_url}">${file.name}</a>`;
            }

            list.appendChild(li);
        });
    });

    fetch(`https://api.github.com/repos/${owner}/${repo}/contents/files/data/list.json`)
      .then(res => res.json())
      .then(data => {
    
        data.items.forEach(item => {
          const li = document.createElement("li");
    
          if (item.type === "folder") {
            li.innerHTML = `ğŸ“ <a href="?path=${item.path}">${item.name}/</a>`;
          } else {
            li.innerHTML = `ğŸ“„ <a href="${item.url}" target="_blank">${item.name}</a>`;
          }
    
          list.appendChild(li);
        });
    });

  </script>
</body>
</html>

